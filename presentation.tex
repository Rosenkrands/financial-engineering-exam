\documentclass{beamer}

\setbeamertemplate{section in toc}[sections numbered]
\setbeamertemplate{subsection in toc}[subsections numbered]

% american mathematical society
\usepackage{amsmath,amsthm,amssymb}

% drawing functionality
\usepackage{tikz}
\usetikzlibrary{matrix}

% equation numbering
\numberwithin{equation}{section}

% theorem types
\newtheorem{proposition}{Proposition}

% math operators
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\var}{Var}
\DeclareMathOperator*{\cov}{Cov}
\DeclareMathOperator{\VaR}{VaR}
\DeclareMathOperator{\cvar}{CVaR}

% additional mathematical fonts
\usepackage{mathrsfs}

% remove navigation bar
\beamertemplatenavigationsymbolsempty

% add slide numbers
\setbeamertemplate{footline}[frame number]

% title
\title{Financial Engineering}
\subtitle{Exam}
\author{Kasper Rosenkrands}
\institute{Aalborg University}
\date{F20}

% toc at each section
\AtBeginSection[]
{
  \begin{frame}
    \frametitle{Table of Contents}
    \tableofcontents[currentsection, hideothersubsections]
  \end{frame}
}


% definition of comment function itself
\newcommand{\comment}[1]{
    \begin{center}
        \colorbox{yellow}{
            \textsf{
                \textbf{#1}
            }
        }
    \end{center}
}
\newcommand{\task}[1]{
    \begin{center}
        \colorbox{red}{
            \textsf{
                \textbf{#1}
            }
        }
    \end{center}
}

\begin{document}

\frame{\titlepage}

\begin{frame}
\frametitle{Table of Contents}
\tableofcontents[hideallsubsections]
\end{frame}

\section{Bonds and the Value of Money Through Time}

\subsection{Bonds}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{definition}[Bond]\label{def:bond}
        A bond is a financial security that pays the owner a chain of predetermined payments.
    \end{definition}
    % \pause
    % \begin{itemize}
    %     \item Financial asset with no risk
    % \end{itemize}
\end{frame}

%\subsection{Value of Money Through Time}
%
%\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
%    \begin{itemize}
%        \item You are offered an amount of money with value $M$
%        \begin{itemize}
%            \item Recieve right away
%            \item Recieve one year from now
%        \end{itemize}
%    \end{itemize}
%\end{frame}

\subsection{Interest Rate}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{definition}[Wealth Process]
        The evolution of an investment over time is called the wealth process of that investment and is denoted by
        \begin{align}
            V = (V_t)_{0 \leq t \leq T}.
        \end{align}
        The initial capital is denoted by $v_0$, and we assume that $V$ is a real-valued stochastic process on a given probability space $(\Omega, \mathscr{F}, \mathbb{P})$.
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{itemize}
        \item Predetermined payments are also known as interest
        \item Fraction of an investment paid either ones or in several periods
        \item Different types of interest
        \begin{enumerate}
            \item Simple
            \item Compounded
            \item Continuously compounded
        \end{enumerate}
    \end{itemize}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{definition}[Simple Interest]
        Let $v_0 \in \mathbb{R}$ be our initial capital.
        An interest on $v_0$ is said to be simple if it follows the wealth process
        \begin{align}\label{eq:simple_interest_wealth_process}
            %V_t = (1 + rt)v_0, \quad 0 \leq t \leq T.
        \end{align}
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    I will now show that the wealth process in \eqref{eq:simple_interest_wealth_process} is indeed a stochastic process in any probability space.
    Any stochastic process $X$ on the probability space $(\Omega, \mathscr{F}, \mathbb{P})$ satisfies
    \begin{align}
        %\{\omega \in \Omega \, : \, X(\omega) \leq x\} \in \mathscr{F}, \quad \forall x \in \mathbb{R}.
    \end{align}
    Suppose $v_0 > 0$ and $x \geq (1 + rt)v_0$ then
    \begin{align}
        %\{\omega \in \Omega \, : \, (1 + rt)v_0 \leq x\} = \{\Omega\} \in \mathscr{F},
    \end{align}
    on the other hand if $x < (1 + rt)v_0$
    \begin{align}
        %\{\omega \in \Omega \, : \, (1 + rt)v_0 \leq x\} = \{\emptyset\} \in \mathscr{F}.
    \end{align}
    %As both $\Omega$ and $\emptyset$ is contained in any $\sigma$-algebra we have shown that the wealth process in \eqref{eq:simple_interest_wealth_process} is a stochastic process in any probability space.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{definition}[Compounded Interest]
        Let $v_0 \in \mathbb{R}$ be our initial capital.
        An interest on $v_0$ is said to be compunded over $m\in\mathbb{N}$ periods if it follows the wealth process
        \begin{align}\label{eq:compund_interest_wealth_process}
            %V_t = \left( 1 + \frac{r}{m} \right)^{mt} v_0, \quad 0 \leq t \leq T.
        \end{align}
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Note that we have the following properties $\forall\, 0 \leq t \leq T$
    \begin{enumerate}
        \item $V_{t + 1} = \left( 1 + \dfrac{r}{m} \right)^{m}V_t$,
        \item If $m_1 > m_2, v_0 > 0 
        \, \Rightarrow \, 
        \left( 1 + \dfrac{r}{m_1} \right)^{m_1t}v_0
        >
        \left( 1 + \dfrac{r}{m_2} \right)^{m_2t}v_0$,
        \item If $m_1 > m_2, v_0 < 0 
        \, \Rightarrow \, 
        \left( 1 + \dfrac{r}{m_1} \right)^{m_1t}v_0
        <
        \left( 1 + \dfrac{r}{m_2} \right)^{m_2t}v_0$.
    \end{enumerate}
    %From this is follows that for an \textit{investor} compund interest is more attractive as it pays more, however as a \textit{debtor} it is less attractive as he or she will have to pay more on his or hers debt.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    At last i can turn to continuously compounded interest which i will present as the limit of \eqref{eq:compund_interest_wealth_process} as $m \rightarrow \infty$.
    Note that by the following definition of $e$
    \begin{align}
        \lim_{x \rightarrow \infty} \left(1 + \frac{1}{x}\right)^x = e,
    \end{align}
    by letting $x = r/m$ in the above the limit of the wealth process of compounded interest can be seen as
    \begin{align}
        \left[\left( 1 + \frac{r}{m} \right)^\frac{m}{r}\right]^{rt}v_0 \rightarrow
        (e)^{rt}v_0, \quad \text{as } m \rightarrow \infty.
    \end{align} 
    This leads to the definition of continuously compounded interest.
\end{frame}

% \begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
%     \begin{definition}[Continuously Compounded Interest]
%         Let $v_0$ be our initial capital.
%         An interest on $v_0$ is said to be continuously compounded at rate $r>0$ if the wealth process
%         \begin{align}
%             V_t = e^{rt}v_0, \quad 0 \leq t \leq T.
%         \end{align}
%     \end{definition}
% \end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    There exists the following relation between the different types of interest
    \begin{align}
        (1 + r) \leq \left(1 + \frac{r}{m}\right)^m < e^r.
    \end{align}
    To show that the relation indeed holds i will show that the sequence
    \begin{align}
        a_m = \left(1 + \frac{r}{m}\right)^m,
    \end{align}
    is increasing.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Using the binomial theorem
    \begin{align*}
        (x+y)^n = \sum_{k=0}^n \begin{pmatrix} n \\ k \end{pmatrix} x^k y^{n-k}
    \end{align*}
    we have 
    \begin{align*}
        \left( 1 + \frac{r}{m} \right)^m &= \sum_{k=0}^m \begin{pmatrix} m \\ k \end{pmatrix} 1^{m-k}\begin{pmatrix} \frac{r}{m} \end{pmatrix}^k\\
        &= \sum_{k=0}^m \begin{pmatrix} m \\ k \end{pmatrix} \begin{pmatrix} \frac{r}{m} \end{pmatrix}^k
    \end{align*}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Each term is of the form
    \begin{align*}
        \begin{pmatrix} m \\ k \end{pmatrix}\begin{pmatrix} \frac{r}{m} \end{pmatrix}^k = \prod_{l=0}^{k-1} \frac{m-l}{k - l} \begin{pmatrix} \frac{r}{m} \end{pmatrix}
    \end{align*}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Each term is of the form
    \begin{align*}
        \frac{m-l}{k-l} \frac{r}{m} &= \frac{rm - lr}{m(k-l)}\\
        &= \frac{m(r - lr/m)}{m(k - l)}\\
        &= \frac{r - lr/m}{k-l}
    \end{align*}
    %The term $\bigstar$ increases with $m$ and thus the product increases with $m$ and thus the sum $\clubsuit$ increases with $m$ and therefore it is an increasing sequence.
\end{frame}

\subsection{Types of Bonds}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    I will discuss the following two types here
    \begin{enumerate}
        \item zero-coupon bonds,
        \item coupon bonds.
    \end{enumerate}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    A \textbf{zero-coupon bond} is a bond with a single payment $F > 0$ at time $T > 0$.
    The pay-off F is called the face value and $T$ the maturity time.
    \vspace{1em}

    The next question i will answer is how much i will be willing to pay for such a financial assest.
    This depends on the way the time value of money is measured.
    \vspace{1em}
    
    Consider for example the following setup; let $B_0 \geq 0$ be the value of the zero-coupon bond with face value $F>0$ and maturity time $T>0$.
    Suppose that only annual compound interest at rate $r>0$ is available.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    From a buyers perspective what if
    \begin{align}\label{eq:zero_coupon_bond_example}
        B_0 > \frac{F}{(1 + r)^T},
    \end{align}
    would i buy the bond?
    \pause
    
    Suppose now that we flip the inequality and look from a sellers perspective, that is if
    \begin{align}\label{eq:zero_coupon_bond_example_seller}
        B_0 < \frac{F}{(1 + r)^T},
    \end{align}
    would i sell the bond?
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Now i will consider the situation where at time $1 \leq t \leq T$ i want to get rid of a bond, but i what to determine what price i should sell it to.
    At this time the bond can be considered a new zero-coupon bond with face value $F > 0$ and maturity time $T - t$.
    Thus we have from the previous argumentation that
    \begin{align}
        B_t = \frac{F}{(1 + r)^{T - t}}, \quad 0 \leq t \leq T.
    \end{align} 
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    The chain of arguments holds also when the time value of money is different, if a compounded interest over $m$ periods where considered then the fair price of a zero-coupon bond at time $t$ would be
    \begin{align}
        B_t = \frac{F}{\left(1 + \frac{r}{m}\right)^{m(T - t)}}.
    \end{align}
    If we consider the continuously compounded case the fair price would be
    \begin{align}
        B_t = \frac{F}{e^{r(T -t)}}.
    \end{align}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    A \textbf{coupon bond} guarantees the owner a payment $F > 0$ at time $T > 0$, as well as a fixed amount $C > 0$ at $t = 1,2,\ldots,T$.
    To find a fair price for such a bond i will follow the same argumentation as above, namely i will compare the price of the bond with the cost of recieving the same benefits with a bank account.
    In other words how much money will i have to deposit in my bank account today if i want to
    \begin{align}
        \text{1.} \quad &\text{withdraw $C > 0$ after 1 year} \\
        \text{2.} \quad &\text{withdraw $C > 0$ after 2 years} \\
        &\quad \vdots \nonumber \\
        \text{$T-1$.} \quad &\text{withdraw $C > 0$ after $T-1$ years} \\
        \text{$T$.} \quad &\text{withdraw $F + C$ after $T$ years}
    \end{align}
    and have nothing left in the bank account afterwards.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    In order to be able to get $C > 0$ after one year i have to put
    \begin{align}
        \frac{C}{1+r}
    \end{align}
    in the bank.
    \pause

    In order to be able to get $C > 0$ after two years i have to put 
    \begin{align}
        \frac{C}{(1+r)^2}
    \end{align}
    in the bank.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Generalizing this argument tells me that in order to recieve $C > 0$ after $t$ years i have to put
    \begin{align}
        \frac{C}{(1+r)^t}
    \end{align}
    in the bank.
    \pause

    Lastly in order to get $F + C$ after $T$ years i have to put
    \begin{align}
        \frac{F + C}{(1+r)^T} = \frac{F}{(1+r)^T} + \frac{C}{(1+r)^T}
    \end{align}
    in the bank.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Adding up all these amounts it is concluded that i have to make a deposit of
    \begin{align}
        \sum_{i = 1}^T \frac{C}{(1 + r)^i} + \frac{F}{(1+r)^T}.
    \end{align}\pause
    The agreeable price of a coupon bond is thus given by
    \begin{align}
        B_0 = 
        \sum_{i = 1}^T \frac{C}{(1 + r)^i} + \frac{F}{(1+r)^T} =
        \frac{\xi_T}{(1 + r)^T}.
    \end{align}\pause
    Where the pay-off $\xi_T$ at time $T$ is given by
    \begin{align}
        \xi_T := \sum_{i = 1}^T C(1 + r)^{T -i} + F,
    \end{align}\pause
    in other words the fair price of the coupon bond (as well as the zero-coupon bond) can be written as the discounted price of the total pay-off.
\end{frame}

\section{Portfolio Allocation and Risk Measures}

\subsection{Portfolio}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Let
        \begin{align}
            \mathfrak{M} = \left\{ 
                \left(
                    \Omega, \mathscr{F}, \mathbb{P}
                \right),
                P = \left(
                    B_t, S_t^{(1)}, \ldots, S_t^{(d)}
                \right)_{0 \leq t \leq T}
            \right\},
        \end{align}
        be a finite-horizon financial market.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    %First and foremost i will give the definition of a portfolio.
    \begin{definition}[Portfolio and Strategies]
        A portfolio in $\mathfrak{M}$ is a $(d + 1)$-dimensional vector
        \begin{align}
            \Theta_t = \left(\varphi_t, \theta_t^{(1)}, \ldots, \theta_t^{(d)}\right),
        \end{align}
        in which
        \begin{align}
            \Theta_t^j = \text{Number of shares of the $j$'th asset held between time $t-1$ and $t$}.
        \end{align}
        for $j = 1, \ldots, d + 1$.
        The collection $\Theta = \left( \Theta_t \right)_{0 \leq t \leq T}$, with the convention that $\Theta_0 = \Theta_1$, is termed a strategy.
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    For every strategy on market there is an associated wealth process.
    The wealth process for $\Theta$ is defined and denoted by
    \begin{align}
        V_t^{\Theta} = \varphi_t B_t + \sum_{j = 1}^d \theta_t^{(j)} S_t^{(j)} = \Theta_t \cdot P_t, \quad 0 \leq t \leq T.    
    \end{align}
\end{frame}

\subsection{Risk Measures}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Any strategy on a given market inherently carries a risk because the return is random, there is in other words no way to predict our profit or losses with certainty.
    There is no one way to measure the risk associated with a strategy, however in the next two sections i will explore two approaches.
    Both of these is based on portfolio allocation as an optimization problem.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    The problem is given in this way; solve
    \begin{align}
        \argmin_{\textbf{w}\in\mathbb{R}^{d+1}}
        \mathcal{R}\left( \textbf{w} \cdot \textbf{K}_P \right),
    \end{align}
    subject to:
    \begin{align}
        \sum_{j = 0}^d w_j = 1, \ 
        \mathbb{E}\left[ U(\textbf{w} \cdot \textbf{K}_P) \right] = \mu, \
        \mu \in \mathbb{R},
    \end{align}
    where $\mathcal{R}$ is a measure of risk and $U(\textbf{w} \cdot \textbf{K}_P)$ is the utility of the strategy.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    The mean variance approach assumes the uitility function as the identity, that is
    \begin{align}
        U(x) = x.
    \end{align}
    By letting
    \begin{align}
        \mu_\mathbf{K} := \mathbb{E}\left[\mathbf{K}_P\right],
    \end{align}
    it follows that
    \begin{align}
        \mathbb{E}\left[ U(\mathbf{w} \cdot \mathbf{K}_P) \right] = \mathbf{w} \cdot \mu_\mathbf{K}.
    \end{align}
    Thus the optimization problem, in the mean-variance approach becomes
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{problem}[Optimization Problem Mean-Variance]
        \begin{align}
            &\quad\argmin_{\mathbf{w}\in\mathbb{R}^{d+1}} \sqrt{\mathbf{w}^\top C \mathbf{w}} \\
            &\text{Subject to:} \nonumber \\
            &\qquad \text{1.) }\sum_{j = 0}^d w_j = 1, \\
            &\qquad \text{2.) }\mathbf{w} \cdot \mu_\mathbf{K} = \mu, \quad \mu \in \mathbb{R}.
        \end{align}
    \end{problem}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    An illustrative example to demonstrate why one might consider a different risk measure than the standard deviation is the following.
    Consider two portfolios that generate the following wealth
    \begin{align}
        V_1^{(1)} = 
        \begin{cases}
            1 &\text{with probability $1/2$} \\
            -9 &\text{with probability $1/2$}
        \end{cases}
    \end{align}
    and
    \begin{align}
        V_1^{(2)} = 
        \begin{cases}
            5 &\text{with probability $1/2$} \\
            -5 &\text{with probability $1/2$}
        \end{cases}
    \end{align}
    According to their standard deviation these two portfolios carries the same risk, but one could argue that the first is riskier that the latter.
    The next risk measure i will consider i concerned with controlling losses rather than the variation of the return.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    If i denote the outcome of an investment with $V_1$ then my potential losses will be given by $-V_1$.
    Suppose that for some $x \in \mathbb{R}$
    \begin{align}
        -V_1 \leq x.
    \end{align}
    Then to cover my risk of bankruptcy i must keep at least the amount $x$ in my bank account.
    In reality the only thing i can quantify is the chance of that happening, which is denoted by
    \begin{align}
        \mathbb{P}\left( -V_1 \leq x \right).
    \end{align}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    This is the motivation behind the risk measure Value at Risk.
    \begin{definition}[Value at Risk]
        Let $0 < \alpha < 1$ and $X$ be a random variable.
        The Value at Risk (VaR) of $X$ is defined and denoted by
        \begin{align}
            \VaR_\alpha(X) := \inf
            \left\{
                x \in \mathbb{R} \, : \,
                \mathbb{P}(X + x \geq 0)
                \geq 1 - \alpha
            \right\}.
        \end{align}
    \end{definition}
    In other words the $\VaR_\alpha(X)$ represents the amount of extra capital i need to hold in order to reduce my risk of bankruptcy to $1 - \alpha$.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    An alternative representation of $\VaR$ can be formulated using the fact that
    \begin{align}
        \mathbb{P}(-X \leq x) \geq 1 - \alpha
        \, \Longleftrightarrow \,
        \mathbb{P}(X + x < 0) \leq \alpha,
    \end{align}
    this lets us formulate an equivalent representation given by
    \begin{align}
        \VaR_\alpha(X) := \inf
        \left\{
            x \in \mathbb{R} \, : \,
            \mathbb{P}(X < -x) \leq \alpha
        \right\}.
    \end{align}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{proposition}[Properties of $\VaR$]
        Let $X, Y$ be arbitrary random variables.
        Then, the following holds
        \begin{enumerate}
            \item If $X \geq 0$ almost surely, then $\VaR_\alpha(X) \leq 0$.
            \item For all $y\in \mathbb{R}$ we have that $\VaR_\alpha(X + y) = \VaR_\alpha(X) - y$. In particular $\VaR_\alpha(X + \VaR_\alpha(X)) = 0$.
            \item If $\lambda \geq 0$, then $\VaR_\alpha(\lambda X) = \lambda \VaR_\alpha(X)$.
            \item If $X \geq Y$ almost surely, then $\VaR_\alpha(X) \leq \VaR_\alpha(Y)$.
        \end{enumerate}
    \end{proposition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Proof:
    \vspace{6cm}
\end{frame}

\subsection{Coherent Risk Measures}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    %There are one important drawback to measuring risk using $\VaR$ and that is its lack of diversification.
    Note that when using standard deviation as a risk measure we get the following
    \begin{align}
        \sigma(X + Y)^2 = \var(X) + \var(Y) + 2\rho_{X,Y}\sqrt{\var(X)\var(Y)},
    \end{align}
    where $\rho_{X,Y} = \frac{\cov(X,Y)}{\sqrt{\var(X)\var(Y)}} \leq 1$.
    Then
    \begin{align}
        \sigma(X + Y)^2 &= \sigma(X)^2 + \sigma(Y)^2 + 2\rho_{X,Y}\sigma(X)\sigma(Y)\\
        &\leq \sigma(X)^2 + \sigma(Y)^2 + 2\sigma(Y)\sigma(X) = \left[\sigma(X) + \sigma(Y)\right]^2, 
    \end{align}
    which would imply that
    \begin{align}
        \sigma(X + Y) \leq \sigma(X) + \sigma(Y).
    \end{align}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    However $\VaR$ as a risk measure is not able to reproduce this, that is in general we do not have that
    \begin{align}
        \VaR_\alpha(X + Y) \leq \VaR_\alpha(X) + \VaR_\alpha(Y).
    \end{align}
    As diversification is a desired i will know introduce the concept of Coherent Risk Measures.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{definition}[Coherent Risk Measure]
        A function $\rho \, : \, L^1 \rightarrow \mathbb{R}$ is said to be a Coherent Risk Measure if
        \begin{enumerate}
            \item If $X \geq 0$ almost surely, then $\rho(X) \leq 0$.
            \item For all $y \in \mathbb{R}$ we have that $\rho(X + y) = \rho(X) - y$.
            \item If $\lambda \geq 0$, then $\rho(\lambda X) = \lambda \rho(X)$.
            \item We have that $\rho(X + Y) \leq \rho(X) + \rho(Y)$.
        \end{enumerate}
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    The Conditional Value at Risk (CVAR) is a common example of a coherent risk measure.

    Given a random variable $X$, we will write
    \begin{align}
        q_\alpha(X) := \inf \{x \in \mathbb{R} \, : \, \mathbb{P}(X \leq x) \geq \alpha\}.
    \end{align}
    With this notation now introduced i can present the definition of CVaR.
    \pause
    \begin{definition}[Condition Value at Risk]
        Let $ 0 < \alpha < 1$ and $X \in L^1$.
        The Conditional Value at Risk or Expected Shortfall of $X$ is defined and denoted buy
        \begin{align}
            \cvar_\alpha := - \frac{1}{\alpha}\int_0^\alpha q_r(X) \, dr.
        \end{align}
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    The name Expected Shortfall comes from the fact that if $X$ has a continuous distribution, then
    \begin{align}
        \cvar_\alpha(X) = - \mathbb{E}[X \, | \, X + \VaR_\alpha(X) \leq 0].
    \end{align}
    Thus, $\cvar_\alpha$ measures the expected losses given that $\VaR_\alpha(X)$ was not enough to cover our position on $X$.
\end{frame}

\section{The Multi-Step Binomial Model}

\subsection{Model Setup}
\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Consider a model where only two assets are traded: A bond and a risky asset.
    The bond satisfies that
    \begin{align}
        %B_t = (1+r)^t, \quad t = 0,1, \ldots, T.
    \end{align}
    The price process $(S_t)_{t = 0,1, \ldots, T}$ satisfies that $S_0 > 0$ (non-random) and
    \begin{align}
        %S_t = S_{t - 1} (1 + K_s(t)), \quad t = 1, \ldots, T.
    \end{align}
    The returns are independent and identically distributed with
    \begin{align}
        %K_s(t) =
        %\begin{cases}
        %    R_u &\text{with probability } p; \\
        %    R_d &\text{with probability } 1-p,
        %\end{cases}
    \end{align}
    with the relation
    \begin{align}
        %R_d < R_u.
    \end{align}
\end{frame}

\subsection{Market Information}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    I am considering the multi-step financial market
    \begin{align}
        \mathfrak{M} = \left\{
            (\Omega, \mathscr{F}, \mathbb{P}),
            P = \left(
                B_t, S_t^{{\color{black!20!white}(1)}}{\color{black!20!white}, S_t^{(2)}, \ldots, S_t^{(d)}}
            \right)_{t = 0,1, \ldots, T}
        \right\}.
    \end{align}
    In order to further explain how information flows in the market i need to be more specific about the definition of the probability space.
    I will start by letting
    \begin{align}
        \Omega = \left\{
            \left(
                \omega^{(1)}, \omega^{(2)}, \ldots, \omega^{(T)}
            \right)
            \, : \,
            \omega^{(t)} \in \{u,d\}, \, t = 1, 2, \ldots, T
        \right\}.
    \end{align}
    Take for example the two-step binomial model, that is $T = 2$.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    I will consider all possible events, which means that the $\sigma$-algebra in this case is
    \begin{align}
        \mathscr{F} = 2^{\Omega}. \quad \text{(The power set)}
    \end{align}
    Using this set-up the return process can be written as
    \begin{align}
        K_s(t)(\omega^{(1)}, \omega^{(2)}, \ldots, \omega^{(T)}) =
        \begin{cases}
            R_u & \text{if } \omega^{(t)} = u; \\
            R_d & \text{if } \omega^{(t)} = d. 
        \end{cases}
    \end{align}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    To ensure that the returns are independent and can go up and down with probability $p$ and $(1-p)$ respectively, i let
    \begin{align}
        \mathbb{P}\left(
            \left\{
                \omega^{(1)}, \omega^{(2)}, \ldots, \omega^{{\color{black}(T)}}
            \right\}
        \right) =
        p^k(1 - p)^{T-k},
    \end{align}
    where
    \begin{align}
        k = \text{number of $u$'s in } \left(\omega^{(1)}, \omega^{(2)}, \ldots, \omega^{{\color{black}(T)}}\right). 
    \end{align} 
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    As an example lets consider the two-step binomial model, that is $T = 2$ and we have that
    \begin{align}
        \Omega = \left\{ uu, ud, du, dd \right\},
    \end{align}
    using the notational convention that
    \begin{align}
        \left(
            \omega^{(1)}, \omega^{(2)}
        \right)
        =
        \omega^{(1)}\omega^{(2)}.
    \end{align}
\end{frame}

\begin{frame}[fragile]\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{figure}
        \centering
        \begin{tikzpicture}[>=stealth,sloped]
            \matrix (tree) [%
              matrix of nodes,
              minimum size=1cm,
              column sep=2.0cm,
              row sep=.25cm,
              ampersand replacement=\&
            ]
            {
                    \&           \& $S_2^{u,u}$   \\
                    \& $S_1^u$   \&               \\
              $S_0$ \&           \& $S_2^{u,d}$   \\
                    \& $S_1^d$   \&               \\
                    \&           \& $S_2^{d,d}$   \\
            };
            \draw[->, thick] (tree-3-1) -- (tree-2-2) node [midway,above] {\footnotesize{$1 + R_u$}};
            \draw[->, thick] (tree-3-1) -- (tree-4-2) node [midway,below] {\footnotesize{$1 + R_d$}};
            \draw[->, thick] (tree-2-2) -- (tree-1-3) node [midway,above] {\footnotesize{$1 + R_u$}};
            \draw[->, thick] (tree-2-2) -- (tree-3-3) node [midway,below] {\footnotesize{$1 + R_d$}};
            \draw[->, thick] (tree-4-2) -- (tree-3-3) node [midway,above] {\footnotesize{$1 + R_u$}};
            \draw[->, thick] (tree-4-2) -- (tree-5-3) node [midway,below] {\footnotesize{$1 + R_d$}};
          \end{tikzpicture}
        \caption{A graphical representation of the 2-step binomial model.}
        \label{fig:2_step_binomial_model}
    \end{figure}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    At time $t = 0$ no information is available but as time goes by, the price movements reveal information about future outcomes.
    Say for example that at time $t = 1$ the price went down, the future outcomes are restricted to the set
    \begin{align}
        B_d := \left\{ du, dd \right\},
    \end{align}
    as the the events $(uu)$ and $(ud)$ are no longer possible.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    The aforementioned set is related to the information generated by the return process.
    Consider the $\sigma$-field generated by a random variable, which is given by
    \begin{align}
        \sigma(X) = \left\{
            X^{-1}(A) \, : \, A \in \mathscr{B}(\mathbb{R}).
        \right\}
    \end{align}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    This tells me that, in the event that $K_S(1) = R_d$ it follows that
    \begin{align}
        \left\{
            \left(
                \omega^{(1)}, \omega^{(2)}
            \right)
            \, : \,
            K_S(1) = R_d
        \right\} =
        \left\{
            du, dd 
        \right\} = B_d.
    \end{align}
    On the other hand if $K_S(1) = R_u$ it follows that
    \begin{align}
        \left\{
            \left(
                \omega^{(1)}, \omega^{(2)}
            \right)
            \, : \,
            K_S(1) = R_u
        \right\} =
        \left\{
            uu, ud 
        \right\} = B_u.
    \end{align}
    Therefore
    \begin{align}
        B_u, B_d \subseteq \sigma\left(K_S(1)\right).
    \end{align}
    It is in fact so, that because $K_S(1)$ only takes two values
    \begin{align}
        \sigma(K_S(1)) = \left\{B_u, B_d, \Omega, \emptyset\right\}.
    \end{align}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    At the end of the trading period, in this case $t = T = 2$, the outcome of the price movements are known and stored in
    \begin{align}
        \mathscr{F} = \sigma\left(K_S(1), K_S(2)\right).
    \end{align}
    Furthermore there has been constructed a family of sub-$\sigma$-algebras of $\mathscr{F}$;
    \begin{align}
        \mathscr{F}_1 &= \sigma(K_S(1)) = \left\{B_u, B_d, \Omega, \emptyset\right\}. \\
        \mathscr{F}_2 &= \sigma(K_S(1), K_S(2)) = \mathscr{F}.
    \end{align}
    Note that by construction, $\mathscr{F}$ contains the whole information available on the price movements up until time $t$.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Mathematically this means that the price process $S_t$ is adapted to $\mathscr{F}$;
    \begin{align}
        \sigma(S_t) \subseteq \mathscr{F}_t, \quad  t = 0,1,2 \text{ where } \mathscr{F}_0 = \left\{ \Omega, \emptyset \right\},
    \end{align}
    and moreover
    \begin{align}
        \mathscr{F}_{t - 1} \subseteq \mathscr{F}_t, \quad t = 1,2.
    \end{align}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    %A collection of sub-$\sigma$-algebras satisfying the previous relation is called a filtration.
    %A formal defintion is now given.
    \begin{definition}[Filtrations and Adapted Process]
        Fix a probability space $(\Omega, \mathscr{F}, \mathbb{R})$.
        A collection of $\sigma$-algebras $\mathbb{F} = \left(\mathscr{F}_t\right)_{t = 0,1,\ldots,T}$ is called a filtration if for all $1 \leq t \leq T,$
        \begin{align}
            \mathscr{F}_{t - 1} \subseteq \mathscr{F}_{t} \subseteq \mathscr{F}.
        \end{align}
        The quadruplet
        \begin{align}
            (\Omega, \mathscr{F}, \left(\mathscr{F}_t\right)_{0 \leq t \leq T}, \mathbb{P}),
        \end{align}
        is termed a filtered probability space.
        
        Furthermore, a stochastic process $(X_t)_{0 \leq t \leq T}$ is said to be adapted to a filtration $\mathbb{F}$ if
        \begin{align}
            \sigma(X_t) \subseteq \mathscr{F}_t, \quad \forall 0 \leq t \leq T.
        \end{align}
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{definition}[Financial Markets with Information]
        Fix $T, d \in \mathbb{N}$.
        A finite-horizon financial market with information is the pair
        \begin{align}
            \mathfrak{M} =
            \left\{
                \left(
                    \Omega, 
                    \mathscr{F}, 
                    \left(
                        \mathscr{F}_t
                    \right)_{0 \leq t \leq T},
                    \mathbb{P}
                \right),
                P =
                \left(
                    B_t,
                    S_t^{(1)},
                    \ldots,
                    S_t^{(d)}
                \right)_{0 \leq t \leq T}
            \right\},
        \end{align}
        consisting of
        \begin{enumerate}
            \item A filtered probability space 
            $\left(
                \Omega, 
                \mathscr{F}, 
                \left(
                    \mathscr{F}_t
                \right)_{0 \leq t \leq T},
                \mathbb{P}
            \right)$
            \item $P_t$ is adapted.
            \item $S^{(j)}$ is the price process of the $j$'th asset traded in the market
            \item B is a numéraire (e.g. a bond), i.e.
            \begin{align}
                \mathbb{P}(B_t > 0) = 1, \quad \forall \, 0 \leq t \leq T.
            \end{align}
        \end{enumerate}
    \end{definition}
\end{frame}

\subsection{Absence of Arbitrage}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    An arbitrage is understood as a way to generate positive wealth with zero investment and zero risk.
    In the one-step binomial model it is only allowed to allocate wealth ones, namely at time $t = 0$.
    Returns are then measured at time $t = T = 1$.

    In the multi-step binomial model agents will redesign their strategies based on the available information.
    In order to create an arbitrage the portfolio need to be updated every time the price changes.
    Therefore, instead of considering a single portfolio, an arbitrage now consists of a collection of portfolios $\left(\Theta_t\right)_{0 \leq t \leq T}$.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{definition}[Portfolio and Strategy]
        \begingroup
        \footnotesize
        A portfolio in $\mathfrak{M}$ is a $(d + 1)$-dimensional vector $\Theta_t = \left(\varphi_t, \theta_t^{(1)}, \ldots, \theta_t^{(d)}\right)$, in which
        \begin{align}
            \Theta_t^{(j)} = \text{ Number of shares of the $j$'th asset held between time $t - 1$ and $t$.}
        \end{align}
        The collection $\Theta = \left(\Theta_t\right)_{0 \leq t \leq T}$, with the convention that $\Theta_0 = \Theta_1$ is termed a strategy.
        
        The wealth process associated to $\Theta = \left(\Theta_t\right)_{0\leq t \leq T}$ is defined and denoted by
        \begin{align}
            V_t^\Theta :&= \varphi_tB_t + \sum_{j = 1}^d\theta_t^{(j)}S_t^{(j)} = \Theta_t \cdot P_t, \quad 0 \leq t \leq T \\
            \Rightarrow V_0^\Theta &= \varphi_0B_0 + \sum_{j = 1}^d\theta_0^{(j)}S_0^{(j)} = \varphi_1B_0 + \sum_{j = 1}^d\theta_1^{(j)}S_0^{(j)} 
        \end{align} 
        \endgroup
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    The arbitrage approach from the one-step binomial model can not be used when considering the multi-step binomial model as many strategies that from an intuitive point of view should not be thought of as an arbitrage, will be believed to be an arbitrage.
    Consider for example the following situation
    \begin{enumerate}
        \item Injection of capital at $t \geq 1$.
        \item Priviliged information.
        \item Unlimited credit.
    \end{enumerate}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{definition}[Admissible Strategy]
        \begingroup
        %\footnotesize
        Let $\Theta = \left(\varphi_t, \theta_t^{(1)}, \ldots, \theta_t^{(d)}\right)_{0 \leq t \leq T}$ be strategy on the market
        \begin{align}
            \mathfrak{M} =
            \left\{
                \left(
                    \Omega, 
                    \mathscr{F}, 
                    \left(
                        \mathscr{F}_t
                    \right)_{0 \leq t \leq T},
                    \mathbb{P}
                \right),
                P =
                \left(
                    B_t,
                    S_t^{(1)},
                    \ldots,
                    S_t^{(d)}
                \right)_{0 \leq t \leq T}
            \right\}.
        \end{align}
        I will say that $\Theta$ is admissible if:
        \endgroup
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{enumerate}
        \item \textbf{It is self-financed}: It only requires initial capital.
        I will say that $\Theta$ is self financed if
        \begin{align}
            V_t^{\Theta} = \varphi_{t+1}B_t + \sum_{j=1}^d \theta_{t+1}^{(j)}S_t^{(j)}, \quad 0 \leq t \leq T-1. 
        \end{align}
        \item \textbf{Non-anticipative}: It is build up only on current information.
        I will say that $\Theta$ is non-anticipative or predictable if $\Theta_{t+1}$ depends only on the information at time $t$, that is $\Theta_{t+1}$ is $\mathscr{F}_t$-measurable.
        \item \textbf{It has a limited credit line}: There is a non-random constant $C > 0$, such that
        \begin{align}
            V_t^{\Theta} \geq -C, \ \forall \, 0 \leq t \leq T.
        \end{align}
    \end{enumerate}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{definition}[Arbitrage]
        Consider the market
        \begin{align}
            \mathfrak{M} =
            \left\{
                \left(
                    \Omega, 
                    \mathscr{F}, 
                    \left(
                        \mathscr{F}_t
                    \right)_{0 \leq t \leq T},
                    \mathbb{P}
                \right),
                P =
                \left(
                    B_t,
                    S_t^{(1)},
                    \ldots,
                    S_t^{(d)}
                \right)_{0 \leq t \leq T}
            \right\}.
        \end{align}
        An admissible strategy $\Theta = \left(\varphi_t, \theta_t^{(1)}, \ldots, \theta_t^{(d)}\right)_{0 \leq t \leq T}$ is said to be an arbitrage if:
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begingroup
    \small
    \begin{enumerate}
        \item It has zero initial capital:
        \begin{align}
            V_0^\Theta = \varphi_0B_0 + \sum_{j = 1}^d\theta_0^{(j)} \cdot S_0^{(j)} = 0.
        \end{align}
        \item At time $t = T$, i am out of debts with 100\% certainty: Almost surely
        \begin{align}
            V_T^\Theta = \varphi_T B_T + \sum_{j = 1}^d\theta_T^{(j)} \cdot S_T^{(j)} \geq 0.
        \end{align}
        \item I have a chance to make a profit:
        \begin{align}
            \mathbb{P}
            \left(
                \varphi_TB_T + \sum_{j = 1}^d \theta_T^{(j)} \cdot S_T^{(j)} > 0
            \right) > 0.
        \end{align}
    \end{enumerate}
    \endgroup
\end{frame}

\subsection{Risk-Neutral Measure}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    To begin this section i will define the notion of a martingale.
    Fix a filtered probability space
    \begin{align}
        \left(
            \Omega, 
            \mathscr{F}, 
            \left(
                \mathscr{F}_t
            \right)_{0 \leq t \leq T},
            \mathbb{P}
        \right).
    \end{align}
    %Recall that this means that $(\Omega, \mathscr{F}, (\mathscr{F}_t)_{0 \leq t \leq T}, \mathbb{P})$ is a probability space and $(\mathscr{F}_t)_{0 \leq t \leq T}$ is a filtration, i.e. a nested collection of sub-$\sigma$-algebras of $\mathscr{F}$: In symbols
    %\begin{align}
    %    \mathscr{F}_{t-1} \subseteq \mathscr{F}_t \subseteq \mathscr{F}, \quad \forall \, 1 \leq t \leq T. 
    %\end{align}
    I am given a discrete time stochastic process
    \begin{align}
        X = (X_t)_{0 \leq t \leq T}. 
    \end{align}
    Under this framework i give the definition of a martingale.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{definition}[Martingale]\label{def:martingale}
        The collection $\{ (X_t, \mathscr{F}_t): t = 0,1, \ldots, T \}$ is said to be a martingale if
        \begin{enumerate}
            \item %$X$ is adapted, i.e. $\sigma(X_t) \subseteq \mathscr{F}_t, \quad \forall \, 0 \leq t \leq T$.
            \item %$X_t$ has finite first moment, that is $\mathbb{E}(|X_t|) < \infty$. 
            \item %For all $0 \leq t \leq T-1$ we have that almost surely $\mathbb{E}(X_{t + 1} | \mathscr{F}_t) = X_t$. 
        \end{enumerate}
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Consider the risk neutral multi-step binomial model: $B_0 = 1$, $S_0 > 0$ is a non-random constant and
    \begin{align}
        B_t = (1 + r)^t; \quad S_t = S_{t-1}(1 + K_S(t)), \quad t = 1, \ldots, T. 
    \end{align}
    $(K_S(t))_{t = 1, \ldots, T}$ are i.i.d. with 
    \begin{align}
        K_S(t) = 
        \begin{cases}
            R_u &\text{ with probability } q^* \\
            R_d &\text{ with probability } 1-q*
        \end{cases}
    \end{align}
    with the relation $R_d < r < R_u$ and
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    The risk neutral measure is the following:
    \vspace{6cm}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    I will now show that the discounted price
    \begin{align}
        X_t := \frac{S_t}{B_t}, \quad 0 \leq t \leq T, 
    \end{align}
    is a martingale under the filtration
    \begin{align}
        \mathscr{F}_0 &= \{ \emptyset, \Omega\} \label{eq:information_at_time_0} \\
        \mathscr{F}_t &= \sigma(K_S(1), \ldots, K_S(t)), \quad 1 \leq t \leq T. \label{eq:information_at_time_1}  
    \end{align}
    In order to show this, i need to verify that the discounted price satisfies all three conditions in definition \ref{def:martingale} (\nameref{def:martingale})
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    By definition
    \begingroup
    \footnotesize
    \begin{align}
        \mathbb{E}\left(X_{t + 1} | \mathscr{F}_t\right) &= \mathbb{E}\left(\frac{S_{t + 1}}{B_{t + 1}} \, \bigg| \, \mathscr{F}_t\right) \\
        &= \mathbb{E}\left(\frac{S_{t}(1 + K_S(t + 1))}{B_{t + 1}} \, \bigg| \, \mathscr{F}_t\right) \\
        &= \mathbb{E}\left(\frac{S_{t}(1 + K_S(t + 1))}{(1 + r)^{t + 1}} \, \bigg| \, \mathscr{F}_t\right) \\
        &= \mathbb{E}\left(\frac{S_{t}}{(1 + r)^{t + 1}}(1 + K_S(t + 1)) \, \bigg| \, \mathscr{F}_t\right) \\
        \text{{\footnotesize (By the Product Rule)}} &= \frac{S_{t}}{(1 + r)^{t + 1}}\mathbb{E}\left((1 + K_S(t + 1)) \, \bigg| \, \mathscr{F}_t\right) \\
        &= \frac{S_{t}}{(1 + r)^{t}}\frac{1}{(1 + r)}\mathbb{E}\left((1 + K_S(t + 1)) \, \bigg| \, \mathscr{F}_t\right) \\
        &= X_t\frac{1}{(1 + r)}\mathbb{E}\left((1 + K_S(t + 1)) \, \bigg| \, \mathscr{F}_t\right).
    \end{align}
    \endgroup
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    I am now left to show that
    \begin{align}
        \mathbb{E}\left(1 + K_S(t + 1) \, \bigg| \, \mathscr{F}_t\right) = 1 + r,
    \end{align}
    to do this i will use the independence of the returns but let me start by considering $t = 0$.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begingroup
    \footnotesize
    In this case
    \begin{align}
        \mathbb{E}\left((1 + K_S(1)\,|\,\mathscr{F}_0\right) &= \mathbb{E}\left((1 + K_S(1)\,|\,\left\{\emptyset, \Omega\right\}\right) \\
        \text{{\footnotesize (Conditioning on the trivial $\sigma$-algebra)}} &= \mathbb{E}\left((1 + K_S(1)\right) \\
        \text{{\footnotesize (From Risk-Neutrality)}}&= (1 + r).
    \end{align}
    Let me now consider the case when $t \geq 1$
    \begin{align}
        \mathbb{E}\left((1 + K_S(t + 1)\,|\,\mathscr{F}_t\right) &= \mathbb{E}\left((1 + K_S(t + 1)\,|\,K_S(1),\ldots,K_S(t)\right) \\
        \text{{\footnotesize (Indepence prop. of the cond. expectation)}} &= \mathbb{E}\left((1 + K_S(1)\right) \\
        &= (1 + r).
    \end{align}
    \endgroup
\end{frame}

\section{The First Fundamental Theorem of Asset Pricing}

\subsection{The Theorem}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    The Fundamental theorem of asset pricing gives necessary and sufficient conditions for the absence of arbitrage in the market with information, given by
    \begingroup
    \footnotesize
    \begin{align}\label{eq:market_with_information}
        \mathfrak{M} =
        \left\{
            \left(
                \Omega, 
                \mathscr{F}, 
                \left(
                    \mathscr{F}_t
                \right)_{0 \leq t \leq T},
                \mathbb{P}
            \right),
            P =
            \left(
                B_t,
                S_t^{(1)},
                \ldots,
                S_t^{(d)}
            \right)_{0 \leq t \leq T}
        \right\}.
    \end{align}
    \endgroup

    \begin{theorem}[FFTAP]\label{th:fftap}
        The market given by \eqref{eq:market_with_information} is arbitrage free if and only if there is a martingale measure. 
    \end{theorem}
\end{frame}

\subsection{Explaining the Hypothesis}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    To understand the hypothesis presented in the theorem lets first remember the concept of an admissible strategy.
    \begin{definition}[Admissible Strategy]
        Let $\Theta = \left(\varphi_t, \theta_t^{(1)}, \ldots, \theta_t^{(d)}\right)_{0 \leq t \leq T}$ be strategy on the market
        \begingroup
        \footnotesize
        \begin{align}
            \mathfrak{M} =
            \left\{
                \left(
                    \Omega, 
                    \mathscr{F}, 
                    \left(
                        \mathscr{F}_t
                    \right)_{0 \leq t \leq T},
                    \mathbb{P}
                \right),
                P =
                \left(
                    B_t,
                    S_t^{(1)},
                    \ldots,
                    S_t^{(d)}
                \right)_{0 \leq t \leq T}
            \right\}.
        \end{align}
        \endgroup
        I will say that $\Theta$ is admissible if:
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{enumerate}
        \item \textbf{It is self-financed}: It only requires initial capital.
        I will say that $\Theta$ is self financed if
        \begin{align}
            V_t^{\Theta} = \varphi_{t+1}B_t + \sum_{j=1}^d \theta_{t+1}^{(j)}S_t^{(j)}, \quad 0 \leq t \leq T-1. 
        \end{align}
        \item \textbf{Non-anticipative}: It is build up only on current information.
        I will say that $\Theta$ is non-anticipative or predictable if $\Theta_{t+1}$ depends only on the information at time $t$, that is $\Theta_{t+1}$ is $\mathscr{F}_t$-measurable.
        \item \textbf{It has a limited credit line}: There is a non-random constant $C > 0$, such that
        \begin{align}
            V_t^{\Theta} \geq -C, \ \forall \, 0 \leq t \leq T.
        \end{align}
    \end{enumerate}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Next let me recall the notion of arbitrage.
    \begin{definition}[Arbitrage]
        Consider the market
        \begingroup
        \footnotesize
        \begin{align}
            \mathfrak{M} =
            \left\{
                \left(
                    \Omega, 
                    \mathscr{F}, 
                    \left(
                        \mathscr{F}
                    \right)_{0 \leq t \leq T},
                    \mathbb{P}
                \right),
                P =
                \left(
                    B_t,
                    S_t^{(1)},
                    \ldots,
                    S_t^{(d)}
                \right)_{0 \leq t \leq T}
            \right\}.
        \end{align}
        \endgroup
        An admissible strategy $\Theta = \left(\varphi_t, \theta_t^{(1)}, \ldots, \theta_t^{(d)}\right)_{0 \leq t \leq T}$ is said to be an arbitrage if:
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{enumerate}
        \item It has zero initial capital:
        \begin{align}
            V_0^\Theta = \varphi_0B_0 + \sum_{j = 1}^d\theta_0^{(j)} \cdot S_0^{(j)} = 0.
        \end{align}
        \item At time $t = T$, i am out of debts with 100 \% certainty: Almost surely
        \begin{align}
            V_T^\Theta = \varphi_T B_T + \sum_{j = 1}^d\theta_T^{(j)} \cdot S_T^{(j)} \geq 0.
        \end{align}
        \item I have a chance to make a profit:
        \begin{align}
            \mathbb{P}
            \left(
                \varphi_TB_T + \sum_{j = 1}^d \theta_T^{(j)} \cdot S_T^{(j)} > 0
            \right) > 0.
        \end{align}
    \end{enumerate}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Lastly i will define a martingale measure.
    \begin{definition}[Martingale Measure]
        %Let 
        %\begin{align}
        %    \mathfrak{M} = \{ (\Omega, \mathscr{F}, (\mathscr{F}_t)_{0 \leq t \leq T}%, \mathbb{P}), P = (B_t, S_t^{(1)}, \ldots, S_t^{(d)})_{0 \leq t \leq T} \}
        %\end{align}
        %be the market. 
        Let $\mathbb{Q}$ be probability measure on $(\Omega, \mathscr{F})$, that is there are $0 < q^*_i < 1, i = 1, \ldots, N$ such that $\sum_{i=1}^N q^*_i = 1$ and 
        \begin{align}
            \mathbb{Q}(\{ \omega_i \}) = q^*_i \quad \text{for } i = 1, \ldots, N. 
        \end{align}
        We will say that $\mathbb{Q}$ is a martingale measure if under $\mathbb{Q}$ the discounted price $(\Tilde{P}_j^{(j)})_{0 \leq t \leq T}$ is a martingale w.r.t $(\mathscr{F}_t)_{0 \leq t \leq T}$, for every $j = 1,2, \ldots, d+1$.
    \end{definition}
\end{frame}

\subsection{Risk-Neutral and Martingale Measures}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    In the binomial model $q^*$ plays two roles
    \begin{enumerate}
        \item It transform the real-world probabilities (the one observed in the market) ($p$, $1-p$) satisfying that
        \begin{align}
            K_S(t) =
            \begin{cases}
                R_u & \text{with probability } p; \\
                R_d & \text{with probability } 1 - p,            
            \end{cases}
        \end{align}
        into a risk-neutral world in which the ``new'' distribution for the returns
        \begin{align}
            K_S(t) =
            \begin{cases}
                R_u & \text{with probability } q^*; \\
                R_d & \text{with probability } 1 - q^*,            
            \end{cases}
        \end{align}
        is such that
        \begin{align}
            \mathbb{E}_*(K_S(t)) = r, \quad t = 1,2,\ldots,T.
        \end{align}
        \item It transforms the discounted prices into a martingale.
    \end{enumerate}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    In this model the two are actually equivalent.
    Consider the martingale property
    \begin{align}
        \mathbb{E}_*\left( \frac{S_{t + 1}^{(j)}}{B_{t + 1}} \, \bigg| \, \mathscr{F}_t \right) &= \frac{S_{t}^{(j)}}{B_{t}} \\
        \frac{1}{B_{t + 1}}\mathbb{E}_*\left( S_{t + 1}^{(j)} \, \bigg| \, \mathscr{F}_t \right) &= \frac{S_{t}^{(j)}}{B_{t}} \\
        \frac{1}{S_{t}^{(j)}}\mathbb{E}_*\left( S_{t + 1}^{(j)} \, \bigg| \, \mathscr{F}_t \right) &= \frac{B_{t + 1}}{B_{t}} \\
        \mathbb{E}_*\left( \frac{S_{t + 1}^{(j)}}{S_{t}^{(j)}} \, \bigg| \, \mathscr{F}_t \right) &= \frac{B_{t + 1}}{B_{t}},
    \end{align}
    subtracting 1 from both sides i get:
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{align}
        \mathbb{E}_*\left( \frac{S_{t + 1}^{(j)}}{S_{t}^{(j)}} - 1 \, \bigg| \, \mathscr{F}_t \right) &= \frac{B_{t + 1}}{B_{t}} - 1,
    \intertext{taking expectations gives}
        \mathbb{E}_*\left[\mathbb{E}_*\left( \frac{S_{t + 1}^{(j)}}{S_{t}^{(j)}} - 1 \, \bigg| \, \mathscr{F}_t \right)\right] &= \mathbb{E}_*\left[\frac{B_{t + 1}}{B_{t}} - 1\right] \\
        \mathbb{E}_*\left( \frac{S_{t + 1}^{(j)}}{S_{t}^{(j)}} - 1 \right) &= \frac{B_{t + 1}}{B_{t}} - 1 \\
        \mathbb{E}_*\left( K_S(t + 1) \right) &= K_B(t + 1).
    \end{align}
    This is exactly the definition of risk-neutral probabilities.
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \task{Add application to the pricing of financial derivaties.}
\end{frame}

\section{Pricing in the Binomial Model}
\subsection{Methodology for Pricing}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    I will start by outlining the methodology used for pricing derivatives in the binomial model.
    \begingroup
    \footnotesize
    \begin{enumerate}
        \item \textbf{Define a model for the prices}: Specify the dynamics for
        \begin{align}
            P = 
            \left(
                B_t, S_t^{(1)}, \ldots, S_t^{(d)}
            \right)_{0 \leq t \leq T},
        \end{align}
        i.e. describe how the distribution, evolution and behavior of the prices should be\dots according to some empirical facts observed in the data.
        \item \textbf{Indicate a set of information}: Determine what information is available at each point in time, i.e. specify $\left(\mathscr{F}_t\right)_{0 \leq t \leq T}$.
        \item \textbf{Check for arbitrage opportunities}: Establish under which circumstances the proprosed model does not admit an arbitrage, i.e. by the First Fundamental Theorem of Asset Pricing find a martingale measure $\mathbb{Q}$ for the model.
        \item \textbf{Dynamics in the risk-neutral world}: Investigate what the distribution of the price process is under the martingale measure.
        This is necessary as the $\xi = \Phi(P_0, \dots, P_T)$ is a function of the prices.
        \item \textbf{Price the derivative}: Compute the prices of the derivative by
        \begin{align}
            \xi_t := \mathbb{E}_*\left(\frac{B_t}{B_T}\xi \, \bigg| \, \mathscr{F}_t\right)
        \end{align}
    \end{enumerate}
    \endgroup
\end{frame}

%\subsection{Define a model for the prices}
%\subsection{Indicate a set of information}
%\subsection{Check for arbitrage opportunities}
%\subsection{Dynamics in the risk-neutral world}

\subsection{Pricing a Call Option}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Let us now find the inital price of a call option. 
    Recall that such a contract gives the owner the right but not the obligation to buy an asset at a given value, say $C > 0$ at a predetermined point in time, say $T > 0$. 
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    The pay-off is then given by the random variable
    \begin{align}
        \xi = \max\{ S_T - C, 0\} = (S_T - C)^+.
    \end{align}
    Independently of the model, we know by theorem \ref{th:fftap} (FFTAP) that the arbitrage free initial price of such an option is 
    \begin{align}
        \xi_0 = \mathbb{E}_*\left( \frac{B_0}{B_T}(S_T - C)^+\right). 
    \end{align}
    In the multi-step binomial model we have
    \begin{align}
        \xi_0 = \mathbb{E}_* \left( \frac{B_0}{B_T}(S_T - C)^+ \right) = \frac{1}{(1+r)^T} \mathbb{E}_* \left( (S_T-C)^+\right). 
    \end{align}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Using that under the probability measure $\mathbb{Q}$ we have that for all $x = 0, \ldots, T$
    \begin{align}
        p_T(x; q^*) &= \mathbb{Q}\left[ S_T := S_0(1+ R_u)^x(1+R_d)^{T-x}\right]\\
        &= \binom{T}{x}( q^* )^x(1-q^*)^{T-x}
    \end{align}
    it follows that
    \begingroup
    \footnotesize
    \begin{align}
        \mathbb{E}_* \left( (S_T - C)^+ \right) = \sum_{x=0}^T \left( S_0(1+R_u)^x(1+R_d)^{T-x} - C \right)^+ p_T(x; q^*).
    \end{align}
    \endgroup
    Observe that 
    \begin{align}
        \left( S_0(1+R_u)^x(1+R_d)^{T-x} - C \right)^+ \neq 0
    \end{align}
    if and only if 
    \begin{align}
        S_0(1+R_u)^x(1+R_d)^{T-x} > C. 
    \end{align}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Let (with the convention that $\min\{ \emptyset \} = + \infty$)
    \begingroup
    \footnotesize
    \begin{align}
        x_0(S_0, R_u, R_d, T) = \min\{ 0 \leq x \leq T : S_0(1 + R_u)^x(1+R_d)^{T-x} > C\}.
    \end{align}
    \endgroup
    Then
    \begingroup
    \footnotesize 
    \begin{align}
        \mathbb{E}_*\left( (S_T - C)^+\right) &= \sum_{x=0}^T \left( S_0(1+R_u)^x(1 + R_d)^{T-x}  - C \right)^+ p_T(x; q^*)\\
        &= \sum_{x=x_0}^T \left( S_0(1+R_u)^x(1 + R_d)^{T-x}  - C \right)^+ p_T(x; q^*)\\
        &= S_0 \sum_{x=x_0}^T \left((1+R_u)^x(1 + R_d)^{T-x}  - C \right)^+ p_T(x; q^*)
        \\ &\qquad 
        - C \sum_{x=x_0}^T p_T (x; q^*). 
    \end{align}
    \endgroup
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Since
    \begingroup
    \footnotesize 
    \begin{align}
        p_T(x; q^*) = \mathbb{Q} \left[ S_T = S_0(1 + R_u)^x(1+R_d)^{t-x} \right] = \binom{T}{x}(q^*)^x(1-q^*)^{T-x}
    \end{align}
    \endgroup
    Then
    \begingroup
    \footnotesize
    \begin{align}
    (1+R_u)^x(1+R_d)^{T-x} p_T(x; q^*) &= (1+R_u)^x(1+R_d)^{T-x} \times \binom{T}{x} (q^*)^x(1-q^*)^{T-x}\\
    &= \binom{T}{x} [(1 + R_u)q^*]^x \times [(1+R_d)(1-q^*)]^{T-x}
    \end{align}
    \endgroup
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    All in all this implies that the arbitrage free initial price of a call option in the multi step binomial model is given by the formula
    \begingroup
    \small
    \begin{align}\label{eq:crr}
        \xi_0 = \mathbb{E}_* \left( \frac{(S_T - C)^+}{(1+r)^T} \right) = S_0 \Psi_1(T, S_0, C, q^*) - \frac{C}{(1+r)^T} \Psi_2(T, S_0, C, q^*)
    \end{align}
    \endgroup
    where
    \begingroup
    \small
    \begin{align}
        \Psi_1 (T, S_0, C, q^*) &:= \sum_{x = x_0}^T \binom{T}{x} \left[ \frac{1 + R_u}{1+r} q^* \right]^x\left[ \frac{1+R_d}{1+r}(1 - q^*) \right]^{T-x}\\
        \Psi_2 (T, S_0, C, q^*) &:= \sum_{x = x_0}^T p_T(x; q^*)
    \end{align}
    \endgroup
    The expression in \eqref{eq:crr} is known as the \textbf{Cox-Ross-Rubenstein} formula.
\end{frame}

\subsection{Price function for simple derivatives}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begingroup
    \small
    \begin{theorem}[Price Function]\label{th:price_function}
        Within the framework of the multi-step binomial model, let $\xi$ be a simple derivative, that is $\xi = \varphi(S_T)$. 
        Put
        \begin{align}
            F(t,y) := \frac{1}{(1+r)^{T-t}} \mathbb{E}_* \{ \varphi (S_{T-t}^y) \}, \quad y \geq 0, \ 0 \leq t \leq T, 
        \end{align}
        where $(S_t^y)_{0 \leq t \leq T}$ is a process satisfying that $S_0^y = y$ and 
        \begin{align}
            S_t^y = S_{t-1}^y(1 + K_S(t)), t = 1, \ldots, T. 
        \end{align}
        Then, almost surely
        \begin{align}
            F(t, S_t) = \frac{1}{(1+r)^{T-t}} \mathbb{E}_* (\varphi(S_T) | \mathscr{F}_t), 0 \leq t \leq T. 
        \end{align}
        In other words the arbitrage free price of the simple derivative $\xi = \varphi(S_T)$ at time $0 \leq t \leq T$ is given by $F(t, S_t)$. 
    \end{theorem}
    \endgroup
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \textbf{Remark:} The function $F$ is known as the price function associated to the pay-off function $\varphi$. 
    \vspace{1cm}

    \textbf{Interpretation:} The function $F(t,y)$ can be thought as the initial price of a simple derivative with maturity time $T-t$ and pay-off function $\varphi$ under the circumstances that the initial price of the risky asset is $y \geq 0$. 
\end{frame}

\subsection{General Price of a Call option in the Binomial Model}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    According to the previous theorem the price of a call option in the multi step binomial model at time $t = 0,1, \ldots, T$ is given by 
    \begin{align}
        \xi_t = F(t, S_t) = \frac{1}{(1+r)^{T-t}} \mathbb{E}_* \left( (S_T - C)^+ | \mathscr{F}_t \right)
    \end{align}
    where 
    \begin{align}
        F(t,y) = \mathbb{E}_* \left[ \frac{(S_{T-t}^y - C)^+}{(1+r)^{T-t}} \right], y \geq 0, 0 \leq t \leq T
    \end{align}
    in which $(S_t^y)_{0 \leq t \leq T}$ is a process satisfying that $S_0^y = y$ and 
    \begin{align}
        S_t^y = S_{t-1}^y(1 + K_S(t)), t = 1, \ldots, T. 
    \end{align}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    The Cox-Ross-Rubunstein formula dictates that 
    \begin{align}
        F(t, S_0) &= \mathbb{E}_* \left(  \frac{(S_{T-t} - C)^+}{(1+r)^{T-t}} \right)\\
        &= S_0 \Psi_1 (T-t, S_0, C, q^*) - \frac{C}{(1+r)^{T_0}} \Psi_2(T-t, S_0, C, q^*).
    \end{align}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Replacing $S_0$ by $y$ the Cox-Ross-Rubenstein formula we get that 
    \begin{align}
        F(t, y) = y \Psi_1 (T-t, y, C, q^*) - \frac{C}{(1+r)^{T-t}}\Psi_2(T-t, y, C, q^*). 
    \end{align}
    Hence the price call option in the multi-step binomial model is 
    \begingroup
    \small
    \begin{align}
        \xi_t = F(t, S_t) = S_t \Psi_1(T-t, S_t,C, q^*) - \frac{C}{(1+r)^{T-t}} \Psi_2(T-t, S_t, C, q^*).
    \end{align}
    \endgroup
\end{frame}

\section{The Second Fundamental Theorem of Asset Pricing}

\subsection{Market}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    The market with information is given
    \begin{align*}
        \mathfrak{M} = \{ (\Omega, \mathscr{F}, (\mathscr{F}_t)_{0 \leq t \leq T}, \mathbb{P}), P = (B_t, S_t^{(1)}, \ldots, S_t^{(d)})_{0 \leq t \leq T} \}. 
    \end{align*} 
    The filtered probability space $(\Omega, \mathscr{F}, (\mathscr{F}_t)_{0 \leq t \leq T}, \mathbb{P})$ satisfies that 
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{enumerate}
        \item The sample space is finite and our $\sigma$-algebra is the power set: 
        \begin{align*}
           \Omega = \{ \omega_1, \ldots, \omega_N\}, \ N \in \mathbb{N}, \ \mathscr{F} = 2^{\Omega}.
        \end{align*}
        \item There are $0 < p_i < 1$ for $i = 1, \ldots, N$ such that 
        \begin{align*}
            \sum_{i=1}^N p_i &= 1\\
            \mathbb{P}(\{ \omega_i \}) &= p_i, \quad i = 1, \ldots, N
        \end{align*}
        \item The set of information satisfies that $\mathscr{F}_0 = \{ \emptyset, \Omega\}, \mathscr{F}_T = \mathscr{F}$, and 
        \begin{align*}
            \mathscr{F}_{t-1} \subseteq \mathscr{F}_t, \quad 1 \leq t \leq T-1. 
        \end{align*}
    \end{enumerate}
    We will assume that $B$ is deterministic, $B_0 = 1$ and $B_t > 0$, $\forall \ 1 \leq t \leq T$.
\end{frame}

\subsection{The Theorem}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{theorem}[Second Fundamental Theorem of Asset Pricing]
        Let the market 
        \begin{align*}
            \mathfrak{M} = \left\{ (\Omega, \mathscr{F}, (\mathscr{F}_t)_{0 \leq t \leq T}, \mathbb{P}), P = \left(B_t, S_t^{(1)}, \ldots, S_t^{(d)}\right)_{0 \leq t \leq T} \right\}. 
        \end{align*} 
        be as described. 
        Then $\mathfrak{M}$ is complete and arbitrage free if and only if there is a unique martingale measure.
    \end{theorem}
\end{frame}

\subsection{Definitions}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{definition}[Martingale]
        The collection $\{ (X_t, \mathscr{F}_t): t = 0,1, \ldots, T \}$ is said to be a martingale if
        \begin{enumerate}
            \item $X$ is adapted, i.e. $\sigma(X_t) \subseteq \mathscr{F}_t, \quad \forall \, 0 \leq t \leq T$.
            \item $X_t$ has finite first moment, that is $\mathbb{E}(|X_t|) < \infty$. 
            \item For all $0 \leq t \leq T-1$ we have that almost surely $\mathbb{E}(X_{t + 1} | \mathscr{F}_t) = X_t$. 
        \end{enumerate}
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{definition}[Martingale Measure]
        %Let 
        %\begin{align}
        %    \mathfrak{M} = \{ (\Omega, \mathscr{F}, (\mathscr{F}_t)_{0 \leq t \leq T}%, \mathbb{P}), P = (B_t, S_t^{(1)}, \ldots, S_t^{(d)})_{0 \leq t \leq T} \}
        %\end{align}
        %be the market. 
        Let $\mathbb{Q}$ be probability measure on $(\Omega, \mathscr{F})$, that is there are $0 < q^*_i < 1, i = 1, \ldots, N$ such that $\sum_{i=1}^N q^*_i = 1$ and 
        \begin{align}
            \mathbb{Q}(\{ \omega_i \}) = q^*_i \quad \text{for } i = 1, \ldots, N. 
        \end{align}
        We will say that $\mathbb{Q}$ is a martingale measure if under $\mathbb{Q}$ the discounted price $(\Tilde{P}_j^{(j)})_{0 \leq t \leq T}$ is a martingale w.r.t $(\mathscr{F}_t)_{0 \leq t \leq T}$, for every $j = 1,2, \ldots, d+1$.
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{definition}[Admissible Strategy]
        Let $\Theta = \left(\varphi_t, \theta_t^{(1)}, \ldots, \theta_t^{(d)}\right)_{0 \leq t \leq T}$ be strategy on the market
        \begin{align}
            \mathfrak{M} =
            \left\{
                \left(
                    \Omega, 
                    \mathscr{F}, 
                    \left(
                        \mathscr{F}
                    \right)_{0 \leq t \leq T},
                    \mathbb{P}
                \right),
                P =
                \left(
                    B_t,
                    S_t^{(1)},
                    \ldots,
                    S_t^{(d)}
                \right)_{0 \leq t \leq T}
            \right\}.
        \end{align}
        I will say that $\Theta$ is admissible if:
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{enumerate}
        \item \textbf{It is self-financed}: It only requires initial capital.
        I will say that $\Theta$ is self financed if
        \begin{align}
            V_t^{\Theta} = \varphi_{t+1}B_t + \sum_{j=1}^d \theta_{t+1}^{(j)}S_t^{(j)}, \quad 0 \leq t \leq T-1. 
        \end{align}
        \item \textbf{Non-anticipative}: It is build up only on current information.
        I will say that $\Theta$ is non-anticipative or predictable if $\Theta_{t+1}$ depends only on the information at time $t$, that is $\Theta_{t+1}$ is $\mathscr{F}_t$-measurable.
        \item \textbf{It has a limited credit line}: There is a non-random constant $C > 0$, such that
        \begin{align}
            V_t^{\Theta} \geq -C, \ \forall \, 0 \leq t \leq T.
        \end{align}
    \end{enumerate}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{definition}[Arbitrage]
        Consider the market
        \begin{align}
            \mathfrak{M} =
            \left\{
                \left(
                    \Omega, 
                    \mathscr{F}, 
                    \left(
                        \mathscr{F}_t
                    \right)_{0 \leq t \leq T},
                    \mathbb{P}
                \right),
                P =
                \left(
                    B_t,
                    S_t^{(1)},
                    \ldots,
                    S_t^{(d)}
                \right)_{0 \leq t \leq T}
            \right\}.
        \end{align}
        An admissible strategy $\Theta = \left(\varphi_t, \theta_t^{(1)}, \ldots, \theta_t^{(d)}\right)_{0 \leq t \leq T}$ is said to be an arbitrage if:
    \end{definition}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{enumerate}
        \item It has zero initial capital:
        \begin{align}
            V_0^\Theta = \varphi_0B_0 + \sum_{j = 1}^d\theta_0^{(j)} \cdot S_0^{(j)} = 0.
        \end{align}
        \item At time $t = T$, i am out of debts with 100 \% certainty: Almost surely
        \begin{align}
            V_T^\Theta = \varphi_T B_T + \sum_{j = 1}^d\theta_T^{(j)} \cdot S_T^{(j)} \geq 0.
        \end{align}
        \item I have a chance to make a profit:
        \begin{align}
            \mathbb{P}
            \left(
                \varphi_TB_T + \sum_{j = 1}^d \theta_T^{(j)} \cdot S_T^{(j)} > 0
            \right) > 0.
        \end{align}
    \end{enumerate}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begingroup
    \small
    \begin{definition}[Complete Financial Market]
        The market is said to be complete if every European contingent claim $\xi$ (i.e. a random variable that depends on the information up to time $T$) can be replicated, that is, there exists an admissible strategy
        \begin{align}
            \Theta = \left(\varphi_t, \theta_t^{(1)}, \ldots, \theta_t^{(d)}\right)_{0 \leq t \leq T}
        \end{align}
        such that almost surely
        \begin{align}
            \xi = V_T^{\Theta} = \varphi B_T + \sum_{j = 1}^d \theta_T^{(j)}S_T^{(j)}.
        \end{align}
    \end{definition}
    \endgroup
    \begingroup
    \footnotesize
    This means that, if the market is arbitrage free and $\mathbb{P}\left(\xi > 0\right) > 0$, then necessarily
    \begin{align}
        V_0^\Theta > 0.
    \end{align}
    \endgroup
\end{frame}

\subsection{Remarks}
\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    If the market is arbitrage free and complete, then we have a unique arbitrage-free price for any derivative with pay-off $\xi$ which is given by
    \begin{align}
        \mathbb{E}_*\left(\frac{B_t}{B_T}\xi\,\bigg|\,\mathscr{F}_t\right).
    \end{align}
\end{frame}

\subsection{Completeness}
\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    Let $\phi$ be the pay-off function of a simple derivative. We want to find an admissible strategy $\Theta = (\varphi_t, \theta_t)_{0 \leq t \leq T}$ such that 
    \begin{align*}
        \xi = \phi(S_T) = V_T^{\Theta} = \varphi_TB_T + \theta_TS_T. 
    \end{align*}
    Recall that a strategy $\Theta = (\varphi_t, \theta_t)_{0 \leq t \leq T}$ is admissible if: 
    \begin{enumerate}
        \item It is self financed: $(\theta_{t+1} = \# \textit{ of shares held between } t \textit{ and } t+1)$
        \begin{align*}
            \varphi_tB_t + \theta_t S_t = V_t^{\Theta} = \varphi_{t+1}B_t + \theta_{t+1}S_t
        \end{align*}
        \item Non-anticipative: $\Theta_t$ depends on the market information up to time $t$. 
        \item Is has a limited credit line: There is a non-random constant $C > 0$ such that $V_t^{\Theta} \geq - C, \ \forall \, 0 \leq t \leq T$
    \end{enumerate}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{itemize}
        \item When we have $T=1$ we have seen that $\phi(S_1) = V_1^{\Theta} = \varphi B_1 + \theta S_1$ holds if and only if 
        \begin{align*}
            \zeta^u &:= \phi [S_0(1+R_u)] = \varphi B_1 + \theta S_0(1+R_u)\\
            \zeta^d &:= \phi [S_0(1+R_d)] = \varphi B_1 + \theta S_0(1+R_d) \\
            & \Leftrightarrow \begin{bmatrix} B_1 & S_0(1 + R_u)\\ B_1 & S_0(1 + R_d)\end{bmatrix} \begin{bmatrix} \varphi \\ \theta \end{bmatrix} = \begin{bmatrix} \zeta^u\\ \zeta^d\end{bmatrix}
        \end{align*}
            \item This system has a unique solution given by
        \begin{align*}
            \theta = \frac{\zeta^u - \zeta^d}{S_0 (R_u - R_d)}, \varphi = \frac{1}{B_1} \Bigg\{ \frac{\zeta^d(1+R_u) - \zeta^u(1+R_d)}{R_u - R_d} \Bigg\}. 
        \end{align*}
        \item <2-> Moreover for $q^* = \frac{r - R_d}{R_u - R_d}$:
        \begin{align*}
            \theta S_0 + \varphi B_0 = \frac{1}{1+r} \Bigg\{ \zeta^u q^* + \zeta^d(1-q^*) \Bigg\}. 
        \end{align*}
    \end{itemize}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{itemize}
        \item <1-> Suppose that we have found the replicating strategy up to time $t = T-1$, i.e. $(\varphi_t, \theta_t)_{0 \leq t \leq T-1}$ is given . Thus it is left to find $(\varphi_T, \theta_T)$ such that 
        \begin{align}\label{eq:completeness_of_BM}
            \phi(S_T) = V_T^{\Theta} = \varphi_TB_T + \theta_TS_T
        \end{align}
                \item <1-> Using that $S_T = S_{T-1}(1+K_S(T))$, we have that \eqref{eq:completeness_of_BM} holds if and only if 
                \begin{align*}
            \zeta^u_1(S_{T-1}) &= \varphi_T B_T  + \theta_T S_{T-1}(1+R_u)\\
            \zeta^d_1(S_{T-1}) &= \varphi_T B_T  + \theta_T S_{T-1}(1+R_d)\\
        \end{align*}
        where
        \begin{align*}
            \zeta_1^u(y) := \phi[y(1 + R_u)], \zeta_1^d(y):= \phi[y(1 + R_d)]. 
        \end{align*}
    \end{itemize}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{itemize}
        \item <1-> In matrix notation: 
        \begin{align*}
            \begin{bmatrix} B_T & S_{T-1}(1 + R_u)\\ B_T & S_{T-1}(1 + R_d)\end{bmatrix} \begin{bmatrix} \varphi_T \\ \theta_T \end{bmatrix} = \begin{bmatrix} \zeta^u_1 (S_{T-1})\\ \zeta^d_1(S_{T-1})\end{bmatrix}. 
        \end{align*}
    \end{itemize}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{center}
    $\theta = \frac{\zeta^u - \zeta^d}{S_0 (R_u - R_d)}, \quad \varphi = \frac{1}{B_1} \bigg\{ \frac{\zeta^d(1+R_u) - \zeta^u(1+R_d)}{R_u - R_d} \bigg\}$
    \end{center}
    \begin{itemize}
        \item Replacing $S_0, \zeta^u, \zeta^d$ and $B_1$ by $S_{T-1}, \zeta_1^u(S_{T-1}), \zeta_1^d(S_{T-1})$ and $B_T$ respectively in the one step case we get that 
        \begin{align*}
            \theta_T&= \frac{\zeta^u_1 (S_{T-1}) - \zeta_1^d (S_{T-1})}{S_{T-1}(R_u - R_d)}\\
            \varphi_T &= \frac{1}{B_T} \Bigg\{  \frac{\zeta_1^d (S_{T-1})  (1+R_u) - \zeta_1^u (S_{T-1}) (1+R_d)}{R_u - R_d} \Bigg\}. 
        \end{align*}
                \item In a similar way we obtain 
        \begin{align*}
            \varphi_T B_{T-1} + \theta_T S_{T-1} = \frac{1}{1+r} \left[ \zeta_1^u(S_{T-1})q^* + \zeta_1^d(S_{T-1})(1 - q^*) \right]
        \end{align*}
        \item $(\varphi_T, \theta_T)$ are functions exclusively of $S_{T-1}$ and do not rely on $(\varphi_t, \theta_t)_{0 \leq t \leq T-1}$.
    \end{itemize}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{itemize}
        \item I have now found one portfolio, but to show completeness we need the whole strategy
        \item Using similar arguments as well as the self-financed property, one can find the remaining portfolios to form the complete strategy
    \end{itemize}
\end{frame}

\begin{frame}\frametitle{{\normalsize \secname} \\ {\large \subsecname}}
    \begin{itemize}
        \item Binomial model is complete, however this is not true for the Trinomial model
        \vspace{6cm}
    \end{itemize}
\end{frame}

\end{document}
